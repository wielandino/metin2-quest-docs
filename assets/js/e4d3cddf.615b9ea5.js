"use strict";(globalThis.webpackChunkmetin2_quest_docs=globalThis.webpackChunkmetin2_quest_docs||[]).push([[864],{6461(e,n,i){i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>c,toc:()=>d});var l=i(4848),s=i(8453);const t={sidebar_position:6},a="Best Practices",c={id:"best-practices",title:"Best Practices",description:"Design Patterns",source:"@site/docs/best-practices.md",sourceDirName:".",slug:"/best-practices",permalink:"/metin2-quest-docs/best-practices",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Advanced Topics",permalink:"/metin2-quest-docs/advanced-topics"},next:{title:"Quick Reference",permalink:"/metin2-quest-docs/reference"}},r={},d=[{value:"Design Patterns",id:"design-patterns",level:2},{value:"1. Code Organization",id:"1-code-organization",level:3},{value:"2. Reusable Functions",id:"2-reusable-functions",level:3},{value:"3. Defensive Programming",id:"3-defensive-programming",level:3},{value:"4. Clear Error Messages",id:"4-clear-error-messages",level:3},{value:"5. Consistent Naming",id:"5-consistent-naming",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"1. Minimize Quest Flag Access",id:"1-minimize-quest-flag-access",level:3},{value:"2. Early Returns",id:"2-early-returns",level:3},{value:"3. Efficient Loops",id:"3-efficient-loops",level:3},{value:"4. Avoid Redundant Checks",id:"4-avoid-redundant-checks",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"1. Null/Nil Checks",id:"1-nullnil-checks",level:3},{value:"2. Boundary Checks",id:"2-boundary-checks",level:3},{value:"3. Resource Checks",id:"3-resource-checks",level:3},{value:"4. State Validation",id:"4-state-validation",level:3},{value:"Debugging Techniques",id:"debugging-techniques",level:2},{value:"1. Debug Chat Messages",id:"1-debug-chat-messages",level:3},{value:"2. Variable Type Checking",id:"2-variable-type-checking",level:3},{value:"3. Conditional Debugging",id:"3-conditional-debugging",level:3},{value:"4. Quest Flag Inspection",id:"4-quest-flag-inspection",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsx)(n.h2,{id:"design-patterns",children:"Design Patterns"}),"\n",(0,l.jsx)(n.h3,{id:"1-code-organization",children:"1. Code Organization"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Good: Organized and modular\nquest organized_example begin\n    -- Configuration\n    local REQUIRED_LEVEL = 50\n    local REWARD_YANG = 100000\n    \n    -- Helper functions\n    function CheckRequirements()\n        return pc.get_level() >= REQUIRED_LEVEL\n    end\n    \n    state start begin\n        when 9006.click begin\n            if not organized_example.CheckRequirements() then\n                say("Need level "..REQUIRED_LEVEL)\n                return\n            end\n            -- Main logic\n        end\n    end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-reusable-functions",children:"2. Reusable Functions"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'quest shop_system begin\n    -- Reusable cost calculation\n    function CalculateCost(base_cost)\n        if pc.empire ~= npc.empire then\n            return base_cost * 3\n        end\n        return base_cost\n    end\n    \n    -- Reusable purchase logic\n    function Purchase(vnum, cost)\n        if pc.get_gold() >= cost then\n            pc.change_gold(-cost)\n            pc.give_item2(vnum, 1)\n            return true\n        end\n        return false\n    end\n    \n    state start begin\n        when 9006.click begin\n            local cost = shop_system.CalculateCost(10000)\n            if shop_system.Purchase(30001, cost) then\n                say("Purchase complete!")\n            else\n                say("Not enough Yang!")\n            end\n        end\n    end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-defensive-programming",children:"3. Defensive Programming"}),"\n",(0,l.jsx)(n.p,{children:"Always validate input and state:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'when 9006.click begin\n    -- Check prerequisites\n    if pc.is_dead() then\n        return\n    end\n    \n    if pc.get_level() < 50 then\n        say("Minimum level: 50")\n        return\n    end\n    \n    if not pc.hasguild() then\n        say("You need a guild!")\n        return\n    end\n    \n    -- Main logic here\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-clear-error-messages",children:"4. Clear Error Messages"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Good: Specific messages\nif pc.get_level() < 50 then\n    say("You need to be level 50 or higher.")\n    say("Current level: "..pc.get_level())\n    return\nend\n\n-- Bad: Vague messages\nif pc.get_level() < 50 then\n    say("Cannot proceed.")\n    return\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"5-consistent-naming",children:"5. Consistent Naming"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Good: Descriptive, consistent\npc.setqf("daily_monster_kills", 0)\npc.setqf("daily_metin_breaks", 0)\npc.setqf("daily_quest_complete", 0)\n\n-- Bad: Abbreviations, inconsistent\npc.setqf("dmk", 0)\npc.setqf("metin_count", 0)\npc.setqf("qc", 0)\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,l.jsx)(n.h3,{id:"1-minimize-quest-flag-access",children:"1. Minimize Quest Flag Access"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Bad: Multiple reads\nwhen kill begin\n    if pc.getqf("kills") >= 100 then\n        pc.setqf("kills", pc.getqf("kills") + 1)\n    end\nend\n\n-- Good: Read once\nwhen kill begin\n    local kills = pc.getqf("kills")\n    if kills < 100 then\n        pc.setqf("kills", kills + 1)\n    end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-early-returns",children:"2. Early Returns"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Good: Exit early\nwhen kill begin\n    if pc.getqf("complete") == 1 then\n        return  -- Don\'t process if complete\n    end\n    \n    -- Complex logic here\nend\n\n-- Bad: Nested conditions\nwhen kill begin\n    if pc.getqf("complete") == 0 then\n        -- Complex logic here\n    end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-efficient-loops",children:"3. Efficient Loops"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"-- Good: ipairs for arrays\nlocal items = {30001, 30002, 30003}\nfor i, vnum in ipairs(items) do\n    pc.give_item2(vnum, 1)\nend\n\n-- Better: Cache size\nlocal size = #items\nfor i = 1, size do\n    pc.give_item2(items[i], 1)\nend\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-avoid-redundant-checks",children:"4. Avoid Redundant Checks"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Bad: Multiple level checks\nwhen 9006.click begin\n    if pc.get_level() >= 50 then\n        say("Option 1")\n        if pc.get_level() >= 50 then  -- Redundant\n            -- logic\n        end\n    end\nend\n\n-- Good: Check once\nwhen 9006.click begin\n    local level = pc.get_level()\n    \n    if level >= 50 then\n        say("Option 1")\n        -- Use level variable\n    end\nend\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.h3,{id:"1-nullnil-checks",children:"1. Null/Nil Checks"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Safe item selection\nlocal cell = select_item()\nif cell == 0 then\n    say("No item selected.")\n    return\nend\n\n-- Safe type conversion\nlocal input_str = input()\nlocal number = tonumber(input_str)\n\nif not number then\n    say("Invalid number!")\n    return\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-boundary-checks",children:"2. Boundary Checks"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Check array bounds\nlocal items = {30001, 30002, 30003}\nlocal index = 5\n\nif index <= #items then\n    local vnum = items[index]\nelse\n    chat("Index out of bounds!")\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-resource-checks",children:"3. Resource Checks"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Check before giving items\nwhen kill begin\n    -- Inventory space check (implicit in give_item2)\n    pc.give_item2(30001, 1)\n    \n    -- Explicit checks for large quantities\n    if pc.count_item(30001) + 100 <= 200 then  -- Max stack\n        pc.give_item2(30001, 100)\n    else\n        chat("Not enough inventory space!")\n    end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-state-validation",children:"4. State Validation"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Validate state before transitions\nwhen 9006.click begin\n    local current_stage = pc.getqf("quest_stage")\n    \n    -- Only allow certain transitions\n    if current_stage == 0 then\n        set_state(stage_1)\n    elseif current_stage == 1 then\n        set_state(stage_2)\n    else\n        say("Invalid quest state!")\n    end\nend\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"debugging-techniques",children:"Debugging Techniques"}),"\n",(0,l.jsx)(n.h3,{id:"1-debug-chat-messages",children:"1. Debug Chat Messages"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Temporary debug output\nwhen kill begin\n    local kills = pc.getqf("monster_kills")\n    chat("DEBUG: kills = "..kills)  -- Remove before release\n    \n    kills = kills + 1\n    pc.setqf("monster_kills", kills)\n    \n    chat("DEBUG: new kills = "..kills)\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-variable-type-checking",children:"2. Variable Type Checking"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Verify types\nlocal value = pc.getqf("some_flag")\nchat("Type: "..type(value))  -- Should be "number"\nchat("Value: "..tostring(value))\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-conditional-debugging",children:"3. Conditional Debugging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- GM-only debug\nwhen kill with pc.is_gm() begin\n    local kills = pc.getqf("monster_kills")\n    chat("[GM DEBUG] Kills: "..kills)\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"4-quest-flag-inspection",children:"4. Quest Flag Inspection"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'-- Inspect all relevant flags\nwhen 9006.click with pc.is_gm() begin\n    say_title("Debug Info:")\n    say("Kills: "..pc.getqf("monster_kills"))\n    say("Complete: "..pc.getqf("quest_complete"))\n    say("Stage: "..pc.getqf("quest_stage"))\nend\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>c});var l=i(6540);const s={},t=l.createContext(s);function a(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);